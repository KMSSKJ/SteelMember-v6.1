@{;
    ViewBag.Title = "表单页面";
    Layout = "~/Views/Shared/_PrintForm.cshtml";

    var userName = LeaRun.Application.Code.OperatorProvider.Provider.Current().UserName;
}
<script>
    var keyValue = request('keyValue');
    var category = request('category');
    $(function () {
        InitialPage();
        GetOrderEntryGrid();
        initControl();
    });
    //初始化页面
    function InitialPage() {
        //resize重设(表格、树形)宽高
        $(window).resize(function (e) {
            window.setTimeout(function () {
                $('#gridTable').setGridWidth(($('.gridPanel').width()));
                $('#gridTable').setGridHeight($(window).height() - 340.5);
            }, 200);
            e.stopPropagation();
        });
    }
    //加载明细表
    function GetOrderEntryGrid() {
        var $grid = $('#gridTable');
        //$grid.jqGrid({
        //    unwritten: false,
        //    datatype: 'local',
        //    height: $(window).height() - 340.5,
        //    autowidth: true,
        //    colModel: [
        //        { label: '构件编号[<font face="宋体" color="red">*</font>]', name: "MemberNumbering", align: ' center', width: 180, sortable: false },
        //        { label: '构件名称', name: "MemberName", align: ' center', width: 150, sortable: false },
        //        { label: '单位', name: "UnitId", align: ' center', width: 80, sortable: false, align: 'center' },
        //        { label: '生产数量[<font face="宋体" color="red">*</font>]', name: 'MemberNumber', align: ' center', width: 80, sortable: false },
        //        { label: '单价[<font face="宋体" color="red">*</font>]', name: 'Price', align: ' center', width: 80, sortable: false },
        //        { label: '金额[<font face="宋体" color="red">*</font>]', name: 'PriceAmount', align: ' center', width: 120, sortable: false },
        //        { label: 'InfoId', name: 'InfoId',  align: '', sortable: false, resizable: false, hidden: true },
        //        { label: 'MemberId', name: 'MemberId', align: '', sortable: false, resizable: false, hidden: true },
        //        { label: 'MemberDemandId', name: 'MemberDemandId', align: '', sortable: false, resizable: false, hidden: true },
        //        { label: 'MaxNumber', name: 'MaxNumber',  align: '', sortable: false, resizable: false, hidden: true },
        //    ],
        //    pager: false,
        //    rownumbers: true,
        //    shrinkToFit: false,
        //    gridview: true,
        //    footerrow: true,
        //    gridComplete: function () {
        //        //合计
        //        $(this).footerData("set", {
        //            "MemberNumbering": "合计",
        //            "MemberNumber": "<span id='TotalQty'>0</span>",
        //            "Price": "<span id='TotalPrice'>0.00</span>",
        //            "PriceAmount": "<span id='TotalPriceAmount'>0.00</span>",
        //        });
        //    },
        //    ondblclick: function (rowid, e) {
        //        var selectedId = $("#gridTable").jqGrid("getGridParam", "selrow");
        //        $("#gridTable").jqGrid("delRowData", selectedId);
        //    }
        //});
        //默认添加25行 空行
     
            //var rowdata = {
            //    MemberNumbering: '<input readonly id="MemberNumbering➩' + i + '" class="editable" type="text" style="cursor:pointer" datacol="no" err="构件编号" checkexpession="NotNull" /><input id="MemberNumbering➩' + i + '" type="hidden" />',
            //    MemberName: '<input id="MemberName➩' + i + '" class="editable disabled" type="text" />',
            //    UnitId: '<input id="UnitId➩' + i + '" class="editable disabled center" type="text" />',
            //    MemberNumber: '<input id="MemberNumber➩' + i + '" class="editable center" type="text" onkeyup="Conversion(' + i + ')" checkexpession="Number"/>',
            //    Price: '<input id="Price➩' + i + '" class="editable center" type="text" onkeyup="Conversion(' + i + ')" datacol="No" err="单价" checkexpession="Double" />',
            //    PriceAmount: '<input id="PriceAmount➩' + i + '" class="editable disabled center" type="text" datacol="No" err="金额" checkexpession="Double" />',
            //    InfoId: '<input id="InfoId➩' + i + '" type="text" class="editable center" />',
            //    MemberId: '<input id="MemberId➩' + i + '" type="text" class="editable center" />',
            //    MemberDemandId: '<input id="MemberDemandId➩' + i + '" type="text" class="editable center" />',
            //    MaxNumber: '<input id="MaxNumber➩' + i + '" type="text" class="editable center" />',
            //}
            //$grid.jqGrid('addRowData', i, rowdata);

            $grid.append("<tr style='font-weight:bold'><td style='width:35px'>序号</td><td style='width:120px'>构件编号</td><td style='width:120px'>构件名称</td><td style='width:70px'>单位</td><td style='width:90px'>数量</td><td style='width:105px'>备注</td></tr>")
            for (var i = 1; i < 17; i++) {
                $grid.append("<tr><td style='width:35px'>" + i + "</td><td style='width:120px'></td><td style='width:120px'></td><td style='width:70px'></td><td style='width:90px'></td></td><td style='width:105px'></td></tr>")
            } 
    }

    //初始化控件
    function initControl() {
      
        //获取表单
        if (!!keyValue) {
            $.SetForm({
                url: "../../SteelMember/MemberProductionOrder/GetFormJson1",
                param: { keyValue: keyValue },
                success: function (data) {
                   // $("#form1").SetWebControls(data.entity);
                    $("#table1").find("tr:eq(0)").find("td:eq(0)").html(data.entity.Category);
                    $("#table1").find("tr:eq(1)").find("td:eq(0)").html(data.entity.DepartmentId);
                    $("#table1").find("tr:eq(1)").find("td:eq(1)").html(data.entity.ContactPerson);
                    $("#table1").find("tr:eq(1)").find("td:eq(2)").html(data.entity.CreateTime);
                    $("#table1").find("tr:eq(2)").find("td:eq(0)").html(data.entity.ShippingAddress);
                    $("#table1").find("tr:eq(2)").find("td:eq(1)").html(data.entity.ContactPersonTel);
                    $("#table1").find("tr:eq(2)").find("td:eq(2)").html(data.entity.OrderNumbering);
                    $("#table2").find("tr:eq(0)").find("td:eq(0)").html(data.entity.CreateMan);
                    $("#table2").find("tr:eq(0)").find("td:eq(1)").html(data.entity.ReviewMan);

                    //明细
                    var number = "";
                    var childEntity = data.childEntity;
                    $('#gridTable').find('tr').each(function (i) {
                        var row = childEntity[i - 1];
                        if (row != undefined) {
                            //$(this).find('input[id="InfoId➩' + i + '"]').val(row.InfoId);
                            //$(this).find('input[id="MemberId➩' + i + '"]').val(row.MemberId);
                            //$(this).find('input[id="MemberDemandId➩' + i + '"]').val(row.MemberId);
                            //$(this).find('input[id="MemberNumbering➩' + i + '"]').val(row.MemberNumbering);
                            //$(this).find('input[id="MemberName➩' + i + '"]').val(row.MemberName);
                            //$(this).find('input[id="UnitId➩' + i + '"]').val(row.UnitId);
                            //$(this).find('input[id="MemberNumber➩' + i + '"]').val(row.MemberNumber);
                            $(this).find('td:eq(1)').html(row.MemberNumbering);
                            $(this).find('td:eq(2)').html(row.MemberName);
                            $(this).find('td:eq(3)').html(row.UnitId);
                            $(this).find('td:eq(4)').html(row.MemberNumber);
                            $(this).find('td:eq(5)').html(row.Description);
                        }
                    });
                }
            })
        }
    }
    
    //打印
    function btn_print() {
        //$(".bills").printTable();
        $(".bills").jqprint();
    }
</script>
<div class="bills">
        <div>
            <p style="font-size:14pt;padding-bottom:10px;text-align:center"> 云南交投建设集团第十工程有限公司</p>
            <p style="font-size:20pt;padding-bottom:15px;text-align:center;font-family: 华文楷体;font-weight:bold;"> 构件生产申请单</p>
            <table id="table1" class="form"style="width:100%;" >@*style="width:100%;border:1px solid #ccc;"*@
                <tr>
                    <th class="formTitle">
                        工程：
                    </th>
                    <td class="formValue" colspan="8">
                        @*<div id="CollarEngineering" type="selectTree" class="ui-select" style="width:100%" isvalid="yes" checkexpession="NotNull"></div>*@
                    </td>
                    @*<th class="formTitle">
                        领用类型<font face="宋体" color="red">*</font>：
                    </th>
                    <td class="formValue" colspan="4">
                        <select id="CollarType" type="text" class="form-control" style="width:100%;" isvalid="yes" checkexpession="NotNull" list="CollarList">
                            <option value="">==请选择==</option>
                            <option value="生产领用">生产领用</option>
                            <option value="工程领用">工程领用</option>
                            <option value="材料退货">材料退货</option>
                        </select>
                    </td>*@
                </tr>
                <tr>
                    <th class="formTitle">
                        领用单位：
                    </th>
                    <td class="formValue" colspan="2">
                        @*<div id="OrganizeId" type="selectTree" class="ui-select" style="width: 45%;float:left" isvalid="yes" checkexpession="NotNull"></div>&nbsp; —
                        <div id="DepartmentId" type="selectTree" class="ui-select" style="width: 45%;float:right" isvalid="yes" checkexpession="NotNull"></div>*@
                    </td>
                    <th class="formTitle">
                        联系人：
                    </th>
                    <td class="formValue" colspan="2">
                        @*<input id="ContactPerson" type="text" class="form-control" style="width: 100%" isvalid="yes" checkexpession="NotNull" />*@
                    </td>
                    <th class="formTitle">
                        日期：
                    </th>
                    <td class="formValue" colspan="2">
                        @*<input id="Date" type="text" class="form-control input-wdatepicker" placeholder="选择日期" onfocus="WdatePicker({dateFmt: 'yyyy-MM-dd HH:mm:ss' })" />*@
                    </td>
                </tr>

                <tr>
                    <th class="formTitle">
                        收货地址：
                    </th>
                    <td class="formValue" colspan="2">
                        @*<input id="ShippingAddress" type="text" class="form-control" datacol="yes" err="收货地址" checkexpession="NotNull" style="width: 100%" />*@
                    </td>


                    <th class="formTitle">
                        联系电话：
                    </th>
                    <td class="formValue" colspan="2">
                        @*<input id="ContactPersonTel" type="text" class="form-control" style="width: 100%" isvalid="yes" checkexpession="NotNull" />*@
                    </td>
                    <th class="formTitle">
                        单号：
                    </th>
                    <td class="formValue" colspan="2">
                        @*<input id="CollarNumbering" type="text" class="form-control" datacol="yes" err="单号" checkexpession="NotNull" value="@ViewBag.CollarNumbering" style="width: 100%" />*@
                    </td>
                </tr>
            </table>
        </div>
    <div class="gridPanel">
        <table id="gridTable" class="formPrint"></table>
    </div>
        <div class="printArea">
            <table id="table2" class="form" style="width:100%;">
                <tr>
                    <th class="formTitle">
                        申请人：
                    </th>
                    <td class="formValue">
                        @*<input id="CreateMan" type="text" class="form-control" style="width: 100%" value="@ViewBag.CreateMan" />*@
                    </td>
                    <th class="formTitle">
                        经办人：
                    </th>
                    <td class="formValue">
                        @*<input id="Sender" type="text" class="form-control" style="width: 100%" isvalid="yes" checkexpession="NotNull" />*@
                    </td>
                    <th class="formTitle">
                        领用人(签字)：
                    </th>
                    <td class="formValue">
                        @*<input id="CreateTime" type="text" class="form-control" style="width: 100%" datacol="yes" err="制单日期" checkexpession="NotNull" value="@DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")" onfocus="WdatePicker({dateFmt: 'yyyy-MM-dd HH:mm:ss' })" />*@
                    </td>
                </tr>
            </table>
        </div>
</div>
<div id="bottomField">
    <div class="btn-group">
        <a id="lr-print" class="btn btn-default" onclick="btn_print()"><i class="fa fa-print"></i>&nbsp;打印</a>
        @*<a id="lr-export" class="btn btn-default" onclick="btn_export()"><i class="fa fa-sign-out"></i>&nbsp;导出</a>*@
    </div>
    @*<div class="btn-group">
            <a id="lr-prev" class="btn btn-default" onclick="btn_prev()"><i class="fa fa-backward"></i>&nbsp;前单</a>
            <a id="lr-next" class="btn btn-default" onclick="btn_next()"><i class="fa fa-forward"></i>&nbsp;后单</a>
        </div>*@
</div>
<style>
    .form .formTitle {
        width: 65px;
    }

    /*body {
        margin: 0px;
    }

    .bill {
        margin: 10px;
    }

        .bill th {
            text-align: right;
            color: #222222;
        }

        .bill tr {
            margin-bottom: 10px;
        }

        .bill input {
            text-align: left;
            border-width: 0px;
            border-bottom: 1px solid #e2dada;
        }

    .bills {
        overflow: hidden;
        border-radius: 0px;
        position: relative;
        background: #FFFFFF;
        border: 0px solid rgb(204, 204, 204);
        box-shadow: none;
        padding: 0px;
    }

    .ui-widget-content {
        border-left: 0px;
        border-right: 0px;
        border-bottom: 0px;
    }*/
</style>
